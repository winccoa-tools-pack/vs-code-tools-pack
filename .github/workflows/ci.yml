name: CI

on:
  push:
    branches: [ develop, main ]
  pull_request:
    branches: [ develop, main ]

jobs:
  build:
    runs-on: windows-latest

    steps:
      - uses: actions/checkout@v4

      - name: Install dependencies (if any)
        run: |
          if [ -f package.json ]; then
            npm ci || npm install
          else
            echo "No package.json found, skipping npm install"
          fi

      - name: Optional package step (vsix)
        run: |
          if npm run package --silent >/dev/null 2>&1; then
            npm run package
          else
            echo "No package script; attempting to create VSIX with vsce"
            npm install -g @vscode/vsce || true
            vsce package || echo "vsce package failed or not configured"
          fi
